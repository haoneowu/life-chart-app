# Speckit: Specify (Technical Specification)

## 1. Product Overview
**Life Chart** is a viral "Astrology Momentum" application that visualizes a user's life using financial market metaphors. It treats life as a market, fortune/luck as "Momentum," and time as "Candlesticks."
**Tagline:** "This is not astrology. Itâ€™s a chart for your life momentum."

## 2. Core Features (User Stories)
- **Input (Onboarding)**:
    - User enters Birth Date (Required), Birth Time (Optional, default 12:00), and Birth Place (City).
    - System converts location to Lat/Lon/Timezone.
- **Life Candles Chart (Main View)**:
    - **Visual**: Financial candlestick chart (Green/Red candles) representing life momentum.
    - **X-Axis**: Time (Day/Month/Year). Default: Daily view (Last 90 days).
    - **Y-Axis**: Momentum Score (0-100).
    - **Indicators**: "Today" is highlighted.
- **Interpretation (Detail View)**:
    - Click a candle to see: Momentum (Trend), Volatility (Low/Med/High), Signal Tags (e.g., "Communication", "Finance"), and One-line Advice.
    - Interpretation text generated via LLM (cached).
- **Sharing (Viral Loop)**:
    - "Share Today's Candle" generates a shareable image/card with the chart and interpretation.

## 3. Data Model (Schema)

### `users`
- `id`: UUID (Primary Key, Supabase Auth)
- `birth_date`: Date
- `birth_time`: Time (nullable)
- `birth_city`: String
- `latitude`: Float
- `longitude`: Float
- `timezone`: String (IANA)
- `created_at`: Timestamp

### `daily_signals` (Cached Calculations)
- `user_id`: UUID (FK)
- `date`: Date
- `momentum_score`: Integer (0-100)
- `volatility`: Enum ('calm', 'dynamic', 'intense')
- `signal_tags`: Array<String>
- `algo_version`: String
- `created_at`: Timestamp
- **Unique Index**: `(user_id, date, algo_version)`

### `interpretations` (LLM Cache)
- `signal_id`: UUID (FK -> daily_signals.id)
- `content`: JSON (Structured interpretation)
- `created_at`: Timestamp

## 4. Tech Stack
- **Frontend**: Next.js 14+ (App Router), Tailwind CSS, Framer Motion.
- **Charting**: `lightweight-charts` (TradingView style).
- **Backend (API)**: Node.js (deployed on Railway).
    - **Astrology Engine**: `astronomy-engine` (MIT License) - *Critical: No GPL libraries*.
    - **LLM Integration**: OpenAI/Gemini API for generating interpretations.
- **Database**: Supabase (PostgreSQL).
- **Deployment**: Vercel (Frontend), Railway (Backend Service).

## 5. System Architecture
- **Computation Layer**: Deterministic. Uses `astronomy-engine` to calculate planetary transits vs. natal positions.
- **Abstraction Layer**: Converts astrological angles into "Momentum" (0-100) and "Volatility".
- **Presentation Layer**: Renders these values as financial charts.

## 6. UX/UI Guidelines
- **Theme**: Financial/Trading App aesthetic (Dark mode default).
- **Tone**: "Market", "Signal", "Momentum". No "Zodiac" or "Magic" jargon.
- **Performance**: Instant chart rendering; Optimistic UI for switching timeframes.